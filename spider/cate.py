import requests
import re
import spider

# 目标网页
url = "http://sd-get.com/cate-1972-1927.html"
response = requests.get(url)

text = """
<ul class="ul-parent clearfix"><li class="li-parent" data-cateid="1927"><div class="div-parent"><a href="/cate-1972-1927.html">D系列</a><span class="menu_simpline_cur"></span></div></li><li class="li-parent cur" data-cateid="1928"><div class="div-parent"><a href="/cate-1972-1928.html">大宇系列</a><span class="menu_simpline_cur"></span><i class="fa fa-plus"></i></div><div class="ul-submenu"><div class="ul-submenu-up"></div><ul class="clearfix"><li class="li-parent" data-cateid="1970"><div class="div-parent"><a href="/cate-1972-1970.html">大宇220</a></div></li><li class="li-parent" data-cateid="1971"><div class="div-parent"><a href="/cate-1972-1971.html">大宇280</a></div></li><li class="li-parent" data-cateid="1972"><div class="div-parent"><a href="/cate-1972-1972.html">大宇300</a></div></li><li class="li-parent" data-cateid="1973"><div class="div-parent"><a href="/cate-1972-1973.html">大宇360</a></div></li><li class="li-parent" data-cateid="1974"><div class="div-parent"><a href="/cate-1972-1974.html">大宇500</a></div></li></ul></div></li><li class="li-parent" data-cateid="1929"><div class="div-parent"><a href="/cate-1972-1929.html">卡特系列</a><span class="menu_simpline_cur"></span><i class="fa fa-plus"></i></div><div class="ul-submenu"><div class="ul-submenu-up"></div><ul class="clearfix"><li class="li-parent" data-cateid="1965"><div class="div-parent"><a href="/cate-1972-1965.html">卡特312</a></div></li><li class="li-parent" data-cateid="1966"><div class="div-parent"><a href="/cate-1972-1966.html">卡特320</a></div></li><li class="li-parent" data-cateid="1967"><div class="div-parent"><a href="/cate-1972-1967.html">卡特325</a></div></li><li class="li-parent" data-cateid="1968"><div class="div-parent"><a href="/cate-1972-1968.html">卡特330</a></div></li><li class="li-parent" data-cateid="1969"><div class="div-parent"><a href="/cate-1972-1969.html">卡特345</a></div></li></ul></div></li><li class="li-parent" data-cateid="1913"><div class="div-parent"><a href="/cate-1972-1913.html">日立系列</a><span class="menu_simpline_cur"></span></div></li><li class="li-parent" data-cateid="1930"><div class="div-parent"><a href="/cate-1972-1930.html">神钢系列</a><span class="menu_simpline_cur"></span><i class="fa fa-plus"></i></div><div class="ul-submenu"><div class="ul-submenu-up"></div><ul class="clearfix"><li class="li-parent" data-cateid="1961"><div class="div-parent"><a href="/cate-1972-1961.html">神钢60</a></div></li><li class="li-parent" data-cateid="1962"><div class="div-parent"><a href="/cate-1972-1962.html">神钢200</a></div></li><li class="li-parent" data-cateid="1963"><div class="div-parent"><a href="/cate-1972-1963.html">神钢230</a></div></li><li class="li-parent" data-cateid="1964"><div class="div-parent"><a href="/cate-1972-1964.html">神钢350</a></div></li></ul></div></li><li class="li-parent" data-cateid="1931"><div class="div-parent"><a href="/cate-1972-1931.html">沃尔沃系列</a><span class="menu_simpline_cur"></span><i class="fa fa-plus"></i></div><div class="ul-submenu"><div class="ul-submenu-up"></div><ul class="clearfix"><li class="li-parent" data-cateid="1976"><div class="div-parent"><a href="/cate-1972-1976.html">沃210</a></div></li><li class="li-parent" data-cateid="1960"><div class="div-parent"><a href="/cate-1972-1960.html">沃290</a></div></li><li class="li-parent" data-cateid="1959"><div class="div-parent"><a href="/cate-1972-1959.html">沃360</a></div></li></ul></div></li><li class="li-parent" data-cateid="1932"><div class="div-parent"><a href="/cate-1972-1932.html">现代系列</a><span class="menu_simpline_cur"></span></div></li><li class="li-parent" data-cateid="1911"><div class="div-parent"><a href="/cate-1972-1911.html">小松系列</a><span class="menu_simpline_cur"></span><i class="fa fa-plus"></i></div><div class="ul-submenu"><div class="ul-submenu-up"></div><ul class="clearfix"><li class="li-parent" data-cateid="1954"><div class="div-parent"><a href="/cate-1972-1954.html">小松60</a></div></li><li class="li-parent" data-cateid="1955"><div class="div-parent"><a href="/cate-1972-1955.html">小松100</a></div></li><li class="li-parent" data-cateid="1956"><div class="div-parent"><a href="/cate-1972-1956.html">小松200</a></div></li><li class="li-parent" data-cateid="1957"><div class="div-parent"><a href="/cate-1972-1957.html">小松300</a></div></li><li class="li-parent" data-cateid="1958"><div class="div-parent"><a href="/cate-1972-1958.html">小松400</a></div></li></ul></div></li><li class="li-parent" data-cateid="1915"><div class="div-parent"><a href="/cate-1972-1915.html">销子</a><span class="menu_simpline_cur"></span></div></li><li class="li-parent" data-cateid="1953"><div class="div-parent"><a href="/cate-1972-1953.html">组合</a><span class="menu_simpline_cur"></span></div></li></ul>
"""

# 正则表达式匹配类别名称和链接
pattern = re.compile(r'<a href="(/cate-[^"]+)">(.*?)</a>')

matches = pattern.findall(text)

# 解析并打印结果
categories = [{"name": name, "url": "http://sd-get.com" + url} for url, name in matches]

category_id = 1
for category in categories:
    spider.one(category["url"], category["name"], category_id=category_id)
    print(category)
    category_id += 1
